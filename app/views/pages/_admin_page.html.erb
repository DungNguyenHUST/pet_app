<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
    </head>

    <body>
        <div class="container">
            <div class='admin_dasboard'>
                <div class="admin_tab_link">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-toggle="tab" href="#CompanyID">Company</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#UserID">User</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#PostID">Post</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-toggle="tab" href="#ProblemID">Problem</a>
                        </li>
                    </ul>
                </div>

                <div class="admin_tab_content">
                    <div class="tab-content">
                        <div role="tabpanel" id="CompanyID" class="tab-pane fade in active"><br>
                            <div class="company_tab">
                                <h2>Danh sách công ty</h2>
                                <% @companies.each do |company| %>
                                    <div class='company_block'>
                                        <div class='company_name'>
                                            <a> <%=company.id%> | <%= link_to company.name, company_path(company), class: "company_name_label" %> </a>
											
											<div class='approved'>
												<%if company.approved?%>
													<%= form_for(company, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
														<%= f.hidden_field :approved, :value => false %>
														<%= f.submit "Reject", class: "btn btn-large btn-danger" %>
													<% end %>
												<%else%>
													<%= form_for(company, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
														<%= f.hidden_field :approved, :value => true %>
														<%= f.submit "Approve", class: "btn btn-large btn-success" %>
													<% end %>
												<%end%>
											</div>
											
											<div class='company_edit'>
												<%= link_to "Update", edit_company_path(company), class: "btn btn-large btn-success" %>
												<%= link_to 'Delete', [company], method: :delete, class: "btn btn-large btn-danger", data: { confirm: 'Are Are you sure??' } %>
											</div>
                                        </div>

                                        <div class='company_job_block'>
                                            <strong><%=company.company_jobs.count%> jobs</strong>
                                            <%company.company_jobs.each do |company_job|%>
                                                <div class='company_job_name'>
                                                    <a><%=company_job.id%> | <%= link_to (company_job.title), company_company_job_path(company, company_job) %> </a>
                                                </div>
												<div class='approved'>
													<%if company_job.approved?%>
														<%= form_for [company, company_job] do |f| %>
															<%= f.hidden_field :approved, :value => false %>
															<%= f.submit "Reject", class: "btn btn-large btn-danger" %>
														<% end %>
													<%else%>
														<%= form_for [company, company_job] do |f| %>
															<%= f.hidden_field :approved, :value => true %>
															<%= f.submit "Approve", class: "btn btn-large btn-success" %>
														<% end %>
													<%end%>
												</div>
                                                <div class='company_job_edit'>
                                                    <%= link_to 'Update', edit_company_company_job_path(company, company_job), class: "btn btn-large btn-success" %>
                                                    <%= link_to 'Delete', [company, company_job], method: :delete, class: "btn btn-large btn-danger", data: { confirm: 'Are Are you sure??' } %>
                                                </div>
                                            <%end%>
											<div class="new_job">
												<%= link_to '<button type="submit">Tạo job mới</button>'.html_safe, new_company_company_job_path(company)%>
											</div>
                                        </div>
										
                                    </div>
                                <%end%>
								<div class="new_company">
									<%= link_to '<button type="submit">Tạo công ty mới</button>'.html_safe, new_company_path%>
								</div>
                            </div>                        
                        </div>

                        <div role="tabpanel" id="UserID" class="tab-pane"><br>
                            <div class="user_tab">
                                <h2>Tất cả user</h2>
                                <% @users.each do |user| %>
                                    <a><%=user.id%> | <%= link_to user.name, user_path(user), class: "admin_name_label" %> </a>
									
									<div class='approved'>
										<%if user.approved?%>
											<%= form_for(user, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => false %>
												<%= f.submit "Reject", class: "btn btn-large btn-danger" %>
											<% end %>
										<%else%>
											<%= form_for(user, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => true %>
												<%= f.submit "Approve", class: "btn btn-large btn-success" %>
											<% end %>
										<%end%>
									</div>
									
                                    <div class='user_edit'>
                                        <%= link_to "Update", edit_user_path(user), class: "btn btn-large btn-success" %>
                                        <%= link_to 'Delete', [user], method: :delete, class: "btn btn-large btn-danger", data: { confirm: 'Are Are you sure??' } %>
                                    </div>
                                <%end%>
                            </div>                        
                        </div>

                        <div role="tabpanel" id="PostID" class="tab-pane"><br>
                            <div class="post_tab">
                                <h2>Tất cả bài viết</h2>
                                <% @posts.each do |post| %>
                                    <a><%=post.id%> | <%= link_to post.title, post_path(post), class: "admin_name_label" %> </a>
									
									<div class='approved'>
										<%if post.approved?%>
											<%= form_for(post, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => false %>
												<%= f.submit "Reject", class: "btn btn-large btn-danger" %>
											<% end %>
										<%else%>
											<%= form_for(post, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => true %>
												<%= f.submit "Approve", class: "btn btn-large btn-success" %>
											<% end %>
										<%end%>
									</div>
									
                                    <div class='post_edit'>
                                        <%= link_to "Update", edit_post_path(post), class: "btn btn-large btn-success" %>
                                        <%= link_to 'Delete', [post], method: :delete, class: "btn btn-large btn-danger", data: { confirm: 'Are Are you sure??' } %>
                                    </div>
                                <%end%>
								<div class="new_post">
									<%= link_to '<button type="submit">Tạo post mới</button>'.html_safe, new_post_path%>
								</div>
                            </div>                        
                        </div>

                        <div role="tabpanel" id="ProblemID" class="tab-pane"><br>
                            <div class="problem_tab">
                                <h2>Tất cả câu hỏi</h2>
                                <% @problems.each do |problem| %>
                                    <a><%=problem.id%> | <%= link_to problem.title, problem_path(problem), class: "admin_name_label" %></a>
									
									<div class='approved'>
										<%if problem.approved?%>
											<%= form_for(problem, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => false %>
												<%= f.submit "Reject", class: "btn btn-large btn-danger" %>
											<% end %>
										<%else%>
											<%= form_for(problem, remote: true, data: { confirm: "Are you sure??"}) do |f| %>
												<%= f.hidden_field :approved, :value => true %>
												<%= f.submit "Approve", class: "btn btn-large btn-success" %>
											<% end %>
										<%end%>
									</div>
									
                                    <div class='problem_edit'>
                                        <%= link_to "Update", edit_problem_path(problem), class: "btn btn-large btn-success" %>
                                        <%= link_to 'Delete', [problem], method: :delete, class: "btn btn-large btn-danger", data: { confirm: 'Are Are you sure??' } %>
                                    </div>
                                <%end%>
								<div class="new_problem">
									<%= link_to '<button type="submit">Tạo câu hỏi mới</button>'.html_safe, new_problem_path%>
								</div>
                            </div>                        
                        </div>
                    </div>
                </div>

                <script type="text/javascript">
                    $(function() { 
                        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
                            localStorage.setItem('lastTab', $(this).attr('href'));
                        });

                        var lastTab = localStorage.getItem('lastTab');
                        if (lastTab) {
                            $('[href="' + lastTab + '"]').tab('show');
                        }
                    });
                </script>
            </div>
        </div>
    </body>
</html>